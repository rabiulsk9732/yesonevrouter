#!/bin/bash
#
# YESRouter vBNG - Bison-Style Environment Configuration
# /etc/yesrouter/yesrouter.env
#

# DPDK Core Configuration
DPDK_MAIN_LCORE=0
DPDK_WORKER_LCORES="1"
DPDK_NUMA_NODE=0

# DPDK Memory Configuration
DPDK_SOCKET_MEM_MB=2048
DPDK_MBUF_COUNT=262144
DPDK_MBUF_CACHE_SIZE=512
DPDK_MBUF_DATA_ROOM=2048

# DPDK Hugepage Configuration
DPDK_HUGEPAGES=2048
DPDK_HUGEPAGE_SIZE="2M"

# NIC Configuration (WAN=06:13.0, LAN=06:14.0)
DPDK_PORTS="0000:06:13.0 0000:06:14.0"
DPDK_DRIVER="vfio-pci"
DPDK_PORT_MTU=1500

# DPDK Queue Configuration (virtio only supports 1 queue)
DPDK_RX_QUEUES=1
DPDK_TX_QUEUES=1
DPDK_RX_DESC=2048
DPDK_TX_DESC=2048

# DPDK Burst Sizes
DPDK_RX_BURST_SIZE=64
DPDK_TX_BURST_SIZE=64

# RSS Configuration
DPDK_RSS_ENABLE=true
DPDK_RSS_HASH_KEY="symmetric"

# Worker Thread Configuration (1 worker for virtio)
WORKER_RX_THREADS=1
WORKER_NAT_THREADS=1
WORKER_TX_THREADS=1

# NAT44 Configuration
NAT44_ENABLE=true
NAT44_HAIRPIN_ENABLE=false
NAT44_MAX_SESSIONS=1048576
NAT44_SESSION_HASH_BUCKETS=65536
NAT44_PORT_BLOCK_SIZE=64
NAT44_MIN_PORT=1024
NAT44_MAX_PORT=65535

# NAT Performance Tuning
NAT44_LOCKLESS_ENABLE=true
NAT44_SESSION_CACHE_SIZE=256
NAT44_PREFETCH_LOOKAHEAD=4

# NAT Pool Configuration (SNAT to WAN IP)
NAT44_POOL_START="103.181.65.166"
NAT44_POOL_END="103.181.65.166"

# NAT Timeouts (Seconds)
NAT44_TIMEOUT_UDP=300
NAT44_TIMEOUT_TCP=7200
NAT44_TIMEOUT_ICMP=60

# Logging Configuration
LOG_LEVEL=6
LOG_FILE="/var/log/yesrouter/yesrouter.log"
LOG_SYSLOG_ENABLE=true

# Runtime Directories
RUNTIME_DIR="/var/run/yesrouter"
DPDK_RUNTIME_DIR="/var/run/dpdk"
CONFIG_DIR="/etc/yesrouter"

# Performance Monitoring
STATS_ENABLE=true
STATS_UPDATE_INTERVAL_MS=1000

# Validation Flag
CONFIG_VALIDATED=false
